<p-toast position="top-right"></p-toast>
<div class="admin-page">
    <p-card
        [header]="editMode ? 'Edit your product' : 'Add your product'"
        subheader="You can add and edit products here!"
    >
        <form [formGroup]="form" (ngSubmit)="onSubmit()">
            <div class="p-grid">
                <div class="p-col-12">
                    <p-toolbar>
                        <div class="p-toolbar-group-right justify-content-end">
                            <p-button
                                [label]="editMode ? 'Update' : 'Create'"
                                type="submit"
                                styleClass="p-button-primary mr-3"
                                icon="pi pi-plus"
                            ></p-button>
                            <p-button
                                label="cancel"
                                routerLink="/products"
                                styleClass="p-button-secondary"
                                icon="pi pi-arrow-circle-left"
                            >
                            </p-button>

                        </div>

                    </p-toolbar>
                </div>
            </div>
            <div class="p-grid pt-3">
                <div class="p-col-12">
                    <div class="p-fluid p-formgrid row">
                        <div class="p-field pt-2 col-md-4">
                            <label class="pb-2" for="name">Name</label>
                            <input
                                formControlName="name"
                                id="name"
                                type="text"
                                pInputText
                            />
                            <small
                                *ngIf="name.invalid && isSubmitted"
                                class="p-error"
                                >Name is required</small
                            >
                        </div>
                        <div class="p-field pt-2 col-md-4">
                            <label class="pb-2" for="brand">Brand</label>
                            <input
                                formControlName="brand"
                                id="brand"
                                type="text"
                                pInputText
                            />
                            <small
                                *ngIf="brand.invalid && isSubmitted"
                                class="p-error"
                                >Brand is required</small
                            >
                        </div>
                        <div class="p-field pt-2 col-md-4">
                            <label class="pb-2" for="price">Price</label>
                            <p-inputNumber
                                formControlName="price"
                                mode="decimal"
                                inputId="price"
                                [useGrouping]="false"
                            >
                            </p-inputNumber>
                            <small
                                *ngIf="price.invalid && isSubmitted"
                                class="p-error"
                                >Price is required</small
                            >
                        </div>
                    </div>
                    <div class="p-fluid p-formgrid row">
                        <div class="p-field pt-2 col-md-4">
                            <label class="pb-2" for="countInStock"
                                >Count in stock</label
                            >
                            <p-inputNumber
                                formControlName="countInStock"
                                mode="decimal"
                                inputId="countInStock"
                                [useGrouping]="false"
                            >
                            </p-inputNumber>
                            <small
                                *ngIf="countInStock.invalid && isSubmitted"
                                class="p-error"
                                >CountInStock is required</small
                            >
                        </div>
                        <div class="p-field pt-2 col-md-4">
                            <label class="pb-2" for="category">Category</label>

                            <p-dropdown
                                [options]="categories"
                                formControlName="category"
                                placeholder="Select a Category"
                                optionLabel="name"
                                optionValue="_id"
                                [showClear]="true"
                                [filter]="true"
                                filterBy="name"
                            ></p-dropdown>

                            <small
                                *ngIf="category.invalid && isSubmitted"
                                class="p-error"
                                >Category is required</small
                            >
                        </div>
                        <div class="p-field pt-2 col-md-4">
                            <label class="pb-2" for="isFeatured"
                                >Is feature</label
                            >
                            <p-inputSwitch
                                class="d-block"
                                inputId="isFeatured"
                                formControlName="isFeatured"
                            ></p-inputSwitch>
                        </div>
                    </div>
                </div>
                <div class="p-fluid">
                    <div class="p-field pt-2 col-md-12">
                        <label class="pb-2" for="description"
                            >Count in stock</label
                        >
                        <textarea
                            [rows]="5"
                            cols="30"
                            id="description"
                            formControlName="description"
                            pInputTextarea
                        ></textarea>
                        <small
                            *ngIf="description.invalid && isSubmitted"
                            class="p-error"
                            >Description is required</small
                        >
                    </div>
                </div>
                <div class="p-fluid">
                    <div class="p-field pt-2 col-md-12">
                        <label class="pb-2" for="richDescription"
                            >Rich description</label
                        >
                        <!-- <p-editor formControlName="richDescription" [style]="{'height':'320px'}">
                        </p-editor> -->
                        <p-editor
                            formControlName="richDescription"
                            [style]="{ height: '320px' }"
                            id="richDescription"
                        ></p-editor>
                        <small
                            *ngIf="description.invalid && isSubmitted"
                            class="p-error"
                            >Description is required</small
                        >
                    </div>
                </div>

                <div class="p-fluid">
                    <div class="pt-2 col-md-12">
                        <label class="pb-2" for="file">Main image</label>
                        <input
                            class="p-inputtext"
                            type="file"
                            id="file"
                            accept="image/*"
                            (change)="onImageUpload($event)"
                        />
                    </div>
                </div>
                <div class="p-fluid">
                    <div class="p-field pt-2 col-md-3">
                        <img
                            class="width-100"
                            style="width: 100%"
                            [src]="imageDisplay"
                            alt=""
                        />
                    </div>
                </div>
            </div>
        </form>
    </p-card>
</div>
